<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Alfred Sang - javascript</title>
      <link href="http://i5ting.com/feed" type="application/rss+xml" rel="alternate" title="Alfred Sang RSS Feed" />
    <link href='http://fonts.googleapis.com/css?family=Noto+Serif|Montserrat:700' rel='stylesheet' type='text/css'>
    <link rel='stylesheet'  href='http://i5ting.com/theme/css/normalize.css' type='text/css' media='all' />
    <link rel='stylesheet'  href='http://i5ting.com/theme/css/github-bf51422f4bb36427d391e4b75a1daa083c2d840e.css' type='text/css' media='all' />
    <link rel='stylesheet'  href='http://i5ting.com/theme/css/style.css' type='text/css' media='all' />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <!--[if lt IE 9]> <script src="http://i5ting.com/theme/js/vendor/html5shiv.js"></script> <![endif]-->
</head>
<body>
  <section class="l-cover">
    <h2>献给我的同代人</h2>
    作者：舒婷<br>
<br>
    　　他们在天上<br>
    　　愿为一颗星<br>
    　　他们在地上<br>
    　　愿为一盏灯<br>
    　　不怕显得多么渺小<br>
    　　只要尽其可能<br><br>

    　　唯因不被承认<br>
    　　才格外勇敢真诚<br>
    　　即使像眼泪一样跌碎<br>
    　　敏感的大地<br>
    　　处处仍有<br>
    　　持久而悠远的回声<br><br>

    　　为开拓心灵的处女地<br>
    　　走入禁区，也许——<br>
    　　就在那里牺牲<br>
    　　留下歪歪斜斜的脚印<br>
    　　给后来者<br>
    　　签署通行证<br><br>

    　　　1980.4
    <header id="banner" class="body">
      <h1 class="site-name"><a href="http://i5ting.com/">Alfred Sang</a></h1>
      <p class="description">
        Manager、全栈工程师（Web, iOS）<br>80 后，桑世龙<br />
        [<a href="http://i5ting.com/pages/about/">关于</a>, <a href="http://i5ting.com/pages/novel/">小说</a>, <a href="http://i5ting.com/pages/poem/">诗歌
        </a>, <a href="http://i5ting.com/pages/thought/">随想</a>]
      </p>
      <ul class="social-links">
        <li><a href="https://twitter.com/i5ting">Twitter</a></li>
        <li><a href="https://github.com/i5ting">Github</a></li>
        <li><a href="http://dribbble.com/i5ting">Dribbble</a></li>
      </ul>
    </header>
  </section>
  <section class="l-content">
    <div class="inner">
  <article class="index-article">
    <header>
      <a href="http://i5ting.com/2012/02/codesigin/">
        <h2 class="article-title">Code Sign error</h2>
      </a>
      <p class="article-meta" title="2012-02-27T00:00:00">27 Feb 2012</p>
    </header>
    <div class="typo article-body">
      <p>更新证书错误Code Sign error: Provisioning profile ‘XXXX'can't be found
2012-02-27 17:03 (分类:默认分类)
在Xcode中当你在更新了你得证书而再重新编译你的程序，真机调试一直会出现 Code Sign error: Provisioning profile ‘XXXX’ can't be found是不是会另你很恼火。下面说说解决方法，让你很好的解决这个问题。</p>
<p>1.关闭你的项目，找到项目文件XXXX.xcodeproj，在文件上点击右键，选择“显示包内容”（Show Package Contents）。会新打开一个Finder。注：其实XXXX.xcodeproj就是一个文件夹，这里新打开的一个Finder里面的三个文件就是该XXXX.xcodeproj文件夹里面的文件。 </p>
<p>2.在新打开的Finder中找到project.pbxproj，并且打开。在这之中找到你之前的证书的编码信息。我之前报的错误信息是Code Sign error: Provisioning profile '37D44E7F-0339-4277-9A82-C146A944CD46'，所以我用查找的方式找到了所有包括37D44E7F-0339-4277-9A82-C146A944CD46的行，并且删除。 </p>
<p>3.保存，重新启动你的项目，再编译。就OK了。   </p>
<p>此问题，真恶心</p>
    </div>
    <div class="read-more clearfix">
      <a class="button radius secondary small right" href="http://i5ting.com/2012/02/codesigin/">阅读全文</a>
      <a class="button radius secondary small right" href="http://i5ting.com/2012/02/codesigin/#disqus_thread">评论</a>
    </div>
    <div class="hr"></div>
  </article>
  <article class="index-article">
    <header>
      <a href="http://i5ting.com/2011/09/iscroll/">
        <h2 class="article-title">iscroll－V3.7.2发布</h2>
      </a>
      <p class="article-meta" title="2011-09-23T00:00:00">23 Sep 2011</p>
    </header>
    <div class="typo article-body">
      <p>2011-09-23 09:20 (分类:默认分类)</p>
<div class="highlight"><pre><span class="cm">/**</span>
<span class="cm">* </span>
<span class="cm">* Find more about the scrolling function at</span>
<span class="cm">* http://cubiq.org/iscroll</span>
<span class="cm">*</span>
<span class="cm">* Copyright (c) 2010 Matteo Spinelli, http://cubiq.org/</span>
<span class="cm">* Released under MIT license</span>
<span class="cm">* http://cubiq.org/dropbox/mit-license.txt</span>
<span class="cm">* </span>
<span class="cm">* Version 3.7.1 - Last updated: 2010.10.08</span>
<span class="cm">* </span>
<span class="cm">*/</span>
</pre></div>


<div class="highlight"><pre><span class="cm">/**</span>
<span class="cm">* iScroll3是（../jslib/iscroll3.7.1.js）版本的改造，把iScroll类名改为iScroll3</span>
<span class="cm">* </span>
<span class="cm">* i3 vs i4 difference:</span>
<span class="cm">* 1. i3没有放大（zoom）事件，所以嵌入内部不会产生事件冒泡问题</span>
<span class="cm">* 2. i3和i4完全不一样的api,i4功能更强健一些</span>
<span class="cm">*</span>
<span class="cm">* @modified by alfred.sang@androtimes.com</span>
<span class="cm">*</span>
<span class="cm">* 增加2个全局变量</span>
<span class="cm">*   1）  currentXPage:1,</span>
<span class="cm">*   2）  _isPageFliped:false,//私有    </span>
<span class="cm">*</span>
<span class="cm">* 增加1个配置项</span>
<span class="cm">*   1）  isFullScreen:true,</span>
<span class="cm">*</span>
<span class="cm">* 增加一个回调函数</span>
<span class="cm">*   1）  onScrollXPageFliped:function(){},//翻页事件处理回调函数</span>
<span class="cm">*</span>
<span class="cm">*</span>
<span class="cm">* that.wrapper.offsetWidth是父容器的宽度。计算currentXPage</span>
<span class="cm">* </span>
<span class="cm">* Version 3.7.2 - Last updated: 2011.9.22</span>
<span class="cm">*</span>
<span class="cm">*/</span>   
</pre></div>


<p>2011－09－22 16：09
修改修改currentXPage取值方式，使之更为通用
currentXPage=Math.abs(Math.floor(that.x/that.wrapper.offsetWidth))+1;</p>
<p>把onScrollPageFliped改成onScrollXPageFliped便于以后扩展</p>
<p>that.wrapper.offsetWidth是一个非常有用的scroller宽度。</p>
<p>未改动之前的iScroll3使用方式：</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">myScroll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">iScroll3</span><span class="p">(</span><span class="s1">&#39;scroller&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">snap</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">momentum</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">hScrollbar</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">onScrollEnd</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>

<span class="p">});</span>
</pre></div>


<p>从上面代码可以看出，iScroll3的原型里只有一个回调方法onScrollEnd，这个函数只要是页内任何touch move事件都会触发，这就导致很多很多需要翻页时处理的事，在onScrollEnd发生，而且是多次，资源消耗非常严重。
对于杂志阅读，很多是翻页才加动画效果或页面效果的，而在页内不需要任何事件。
所以性能优化：减少onScrollEnd（）中使用任何代码</p>
<ul>
<li>增加1个配置项</li>
<li>1） isFullScreen:true,</li>
</ul>
<p>当iScroll3嵌套的时候，只要最外层的iScroll3的 isFullScreen即可，内部均为false.所以默认值为true.</p>
<p>下面是测试代码：</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">myScroll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">iScroll3</span><span class="p">(</span><span class="s1">&#39;scroller&#39;</span><span class="p">,</span> <span class="p">{</span>
<span class="nx">snap</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="nx">momentum</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">hScrollbar</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">onScrollEnd</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

<span class="p">},</span>

<span class="nx">onScrollXPageFliped</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

<span class="c1">//翻页时设置不许全屏</span>
<span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">isFullScreen</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>
<span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;onScrollXPageFliped&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">currentXPage</span><span class="p">);</span> 

<span class="p">}</span>

<span class="p">});</span>


<span class="kd">var</span> <span class="nx">myScroll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">iScroll3</span><span class="p">(</span><span class="s1">&#39;scroller&#39;</span><span class="p">,</span> <span class="p">{</span>
<span class="nx">snap</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="nx">momentum</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">hScrollbar</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">isFullScreen</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">onScrollEnd</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="p">},</span>

<span class="nx">onScrollXPageFliped</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;onScrollXPageFliped&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">currentXPage</span><span class="p">);</span> 
<span class="p">}</span>

<span class="p">});</span>
</pre></div>


<ul>
<li>增加一个回调函数</li>
<li>1） onScrollXPageFliped:function(){},//翻页事件处理回调函数</li>
</ul>
<p>测试代码同上</p>
<ul>
<li>增加2个全局变量</li>
<li>1） currentXPage:1,</li>
<li>2） _isPageFliped:false,//私有</li>
</ul>
<p>全局变量使用方法：</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">myScroll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">iScroll3</span><span class="p">(</span><span class="s1">&#39;scroller&#39;</span><span class="p">,</span> <span class="p">{</span>
<span class="nx">snap</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="nx">momentum</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">hScrollbar</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">isFullScreen</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">onScrollEnd</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="p">},</span>

<span class="nx">onScrollXPageFliped</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="c1">//在回调方法内部，使用this对象获得全局变量</span>
<span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;onScrollXPageFliped&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">currentXPage</span><span class="p">);</span>
<span class="nx">_onScrollXPageFlipedCallback</span><span class="p">();</span><span class="c1">//翻页后－回调函数</span>
<span class="p">}</span>
<span class="p">});</span>


<span class="c1">//在回调方法外部，使用myScroll对象获得全局变量</span>
<span class="kd">function</span> <span class="nx">_onScrollXPageFlipedCallback</span><span class="p">(){</span>
<span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;onScrollXPageFliped&#39;</span><span class="o">+</span><span class="nx">myScroll</span><span class="p">.</span><span class="nx">currentXPage</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>源码中currentXPage取决于that.wrapper.offsetWidth
代码如下：
that.currentXPage=Math.abs(Math.floor(that.x/that.wrapper.offsetWidth))+1;</p>
<p>－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－</p>
<p>说明iScroll4和3的区别之一</p>
<p>iscroll4里，是wrapper的第一个子节点。这点在使用用法上很明显</p>
<div class="highlight"><pre><span class="n">that</span><span class="p">.</span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">typeof</span> <span class="n">el</span> <span class="o">==</span> <span class="err">&#39;</span><span class="n">object</span><span class="err">&#39;</span> <span class="o">?</span> <span class="n">el</span> <span class="o">:</span> <span class="n">doc</span><span class="p">.</span><span class="n">getElementById</span><span class="p">(</span><span class="n">el</span><span class="p">);</span>
<span class="n">that</span><span class="p">.</span><span class="n">scroller</span> <span class="o">=</span> <span class="n">that</span><span class="p">.</span><span class="n">wrapper</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</pre></div>


<p>iScroll3里，是父节点</p>
<div class="highlight"><pre><span class="n">that</span><span class="p">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">typeof</span> <span class="n">el</span> <span class="o">==</span> <span class="err">&#39;</span><span class="n">object</span><span class="err">&#39;</span> <span class="o">?</span> <span class="n">el</span> <span class="o">:</span> <span class="n">document</span><span class="p">.</span><span class="n">getElementById</span><span class="p">(</span><span class="n">el</span><span class="p">);</span>
<span class="n">that</span><span class="p">.</span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">that</span><span class="p">.</span><span class="n">element</span><span class="p">.</span><span class="n">parentNode</span><span class="p">;</span>
</pre></div>


<p>html代码如下:</p>
<div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;wrapper&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;scroller&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>


<div class="highlight"><pre><span class="kd">var</span> <span class="nx">myScroll_inner_fullscreen</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">iScroll3</span><span class="p">(</span><span class="s1">&#39;scroller&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">desktopCompatibility</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>
<span class="nx">onScrollEnd</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">});</span>


<span class="kd">var</span> <span class="nx">myScroll_inner_fullscreen</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">iScroll4</span><span class="p">(</span><span class="s1">&#39;wapper&#39;</span><span class="p">,</span> <span class="p">{</span>
<span class="nx">desktopCompatibility</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>
<span class="nx">onScrollEnd</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">});</span>
</pre></div>
    </div>
    <div class="read-more clearfix">
      <a class="button radius secondary small right" href="http://i5ting.com/2011/09/iscroll/">阅读全文</a>
      <a class="button radius secondary small right" href="http://i5ting.com/2011/09/iscroll/#disqus_thread">评论</a>
    </div>
    <div class="hr"></div>
  </article>
  <article class="index-article">
    <header>
      <a href="http://i5ting.com/2011/09/lion/">
        <h2 class="article-title">lion安装小记</h2>
      </a>
      <p class="article-meta" title="2011-09-13T00:00:00">13 Sep 2011</p>
    </header>
    <div class="typo article-body">
      <p>2011-09-13 09:35 (分类:默认分类)</p>
<p>lion安装小记</p>
<p>1、下载lion镜像</p>
<p>http://www.codeios.com/thread-1547-1-1.html</p>
<p>注：我有镜像，需要的可以找我来拷贝（嘻嘻，不知道咋放到公司服务器上，有需要的自己来吧）</p>
<p>直接点击，重启自动安装就可以（大约31分钟左右）</p>
<p>问题是能进入登陆界面但不能登录，大概是10。7不能读10.6用户的数据库</p>
<p>2、重建帐户</p>
<p>重启开机command+s,打</p>
<p>mount -uaw
rm /var/db/.AppleSetupDone
exit</p>
<p>重启之后会提示你重新建立帐户, 创建完成后即可进入系统</p>
<p>ok，可以登录</p>
<p>存在的问题是已有用户丢失，原目录下文件如何处理</p>
<p>解决此问题只需在account里（如果熟悉命令用useradd也可以）新建一个一样名称的帐户即可，目录默认和用户名相同。</p>
<p>目前使用无问题，很好用</p>
<p>具体lion特性，请看http://tech.163.com/digi/11/0720/20/79ECM0HG0016192R.html</p>
    </div>
    <div class="read-more clearfix">
      <a class="button radius secondary small right" href="http://i5ting.com/2011/09/lion/">阅读全文</a>
      <a class="button radius secondary small right" href="http://i5ting.com/2011/09/lion/#disqus_thread">评论</a>
    </div>
    <div class="hr"></div>
  </article>
  <article class="index-article">
    <header>
      <a href="http://i5ting.com/2011/09/json-to-string/">
        <h2 class="article-title">非常好用的JsonToString方法</h2>
      </a>
      <p class="article-meta" title="2011-09-05T00:00:00">05 Sep 2011</p>
    </header>
    <div class="typo article-body">
      <p>2011-09-05 13:12 (分类:默认分类)</p>
<p>非常好用的JsonToString方法</p>
<p>//'</p>
<p>Jsontostring代码 </p>
<p>function JsonToString(o) {   <br />
    var arr = [];<br />
    var fmt = function(s) {<br />
        if (typeof s == 'object' &amp;&amp; s != null) return JsonToStr(s);<br />
        return /^(string|number)$/.test(typeof s) ? "'" + s + "'" : s;<br />
    }<br />
    for (var i in o)<br />
         arr.push("'" + i + "':" + fmt(o[i]));<br />
    return '{' + arr.join(',') + '}';<br />
}  </p>
<p>我反正用的很爽，哈哈</p>
<p>另外: 如果不想json中的数字也被字符串化. 可以改造: return /^(string|number)$/.test(typeof s) ? '"' + s + '"' : s; 为 : return /^(string)$/.test(typeof s) ? '"' + s + '"' : s; (其实就是把number类型的忽略掉而已)</p>
    </div>
    <div class="read-more clearfix">
      <a class="button radius secondary small right" href="http://i5ting.com/2011/09/json-to-string/">阅读全文</a>
      <a class="button radius secondary small right" href="http://i5ting.com/2011/09/json-to-string/#disqus_thread">评论</a>
    </div>
    <div class="hr"></div>
  </article>
  <article class="index-article">
    <header>
      <a href="http://i5ting.com/2011/09/terminal-color/">
        <h2 class="article-title">mac下让终端显示颜色</h2>
      </a>
      <p class="article-meta" title="2011-09-05T00:00:00">05 Sep 2011</p>
    </header>
    <div class="typo article-body">
      <p>2011-09-05 15:05 (分类:默认分类)
mac下让终端显示颜色</p>
<p>alias ls="ls -G"</p>
<p>而linux是</p>
<p>alias ls="ls --color"</p>
<p>fuck  the  differences</p>
    </div>
    <div class="read-more clearfix">
      <a class="button radius secondary small right" href="http://i5ting.com/2011/09/terminal-color/">阅读全文</a>
      <a class="button radius secondary small right" href="http://i5ting.com/2011/09/terminal-color/#disqus_thread">评论</a>
    </div>
    <div class="hr"></div>
  </article>
<p class="paginator">
    Page 1 / 3
        <a href="http://i5ting.com/tag/javascript/page/2/">&raquo;</a>
</p>

<script type="text/javascript">
var disqus_shortname = 'i5ting';
(function () {
var s = document.createElement('script'); s.async = true;
s.type = 'text/javascript';
s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
    </div>
  </section>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-46124852-1', 'zihua.li');
    ga('send', 'pageview');
  </script>
</body>
</html>